Time: $O\((\log n)^4\)$,\quad Space: $O\(1\)$

Suppose that $p$ is prime and write $p-1$ as $2^sd$ where $d$ is odd. By
Fermat's little theorem
\begin{equation*}
    2^sd \equiv 1\quad (\text{mod } p)
\end{equation*}
Now, consider the chain of terms $2^sd 2^{s-1}d, 2^{s-2},\dots, d$ where each is
a square root of the previous one. As the first term is $1$, it's only square
roots modulo $p$ are $1$ and $-1$, therefore this chain ends where we encounter
a $-1$ of if every term is $1$. By contrapossitive, if a number does not
satisfies this criteria, then it's definitively not prime. There exist no number
that fools this method for all choices of $a$.

It is not necessary to check for all values of $a$ for it has been shown that it
suffices to check a small list of possible witnesses for a correct classification.
Table \ref{tab:miller:a} contains some of these with their respective bounds.
Note that all values of $a$ are consecutive primes.

\begin{table}[ht]
    \centering
    \begin{tabular}{l|l}
        \multicolumn{1}{c|}{$n \leq$} & \multicolumn{1}{|c}{$a$}\\
        \hline
        $2.047 \times 10^3$    & $\{2\}$\\
        $1.373 \times 10^6$    & $\{2, 3\}$\\
        $2.532 \times 10^7$    & $\{2, 3, 5\}$\\
        $3.215 \times 10^9$    & $\{2, 3, 5, 7\}$\\
        $2.152 \times 10^{12}$ & $\{2, 3, 5, 7, 11\}$\\
        $3.474 \times 10^{14}$ & $\{2, 3, 5, 7, 11, 13\}$\\
        $3.415 \times 10^{14}$ & $\{2, 3, 5, 7, 11, 13, 17\}$\\
        $3.825 \times 10^{18}$ & $\{2, 3, 5, 7, 11, 13, 17, 19, 23\}$\\
        $3.186 \times 10^{23}$ & $\{2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37\}$\\
        $3.317 \times 10^{24}$ & $\{2, 3, 5, 7, 11, 13, 17, 19, 23, 29, 31, 37, 41\}$
    \end{tabular}
    \caption{Possible witnesses for values of $n$
        \label{tab:miller:a}}
\end{table}

\begin{algorithm}[ht]
    \inputminted[linenos, frame=lines]{python}{./code/algorithms/miller_test.py}
    \caption{Miller Primality Test}
\end{algorithm}

